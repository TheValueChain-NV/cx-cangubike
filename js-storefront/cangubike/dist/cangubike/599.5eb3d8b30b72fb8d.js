"use strict";(self.webpackChunkcangubike=self.webpackChunkcangubike||[]).push([[599],{599:(U,C,r)=>{r.r(C),r.d(C,{MiniCartComponent:()=>D,MiniCartComponentService:()=>m,MiniCartModule:()=>L});var t=r(4650),_=r(3749),o=r(6761),v=r(1086),g=r(6053),p=r(7545),M=r(1059),a=r(4850),P=r(5778),h=r(4290),c=r(8924),l=r(5391),d=r(6895);const O=function(){return{cxRoute:"cart"}},E=function(n){return{count:n}},f=function(n){return{total:n}};let m=(()=>{class n{constructor(e,i,u,A,T){this.activeCartFacade=e,this.authService=i,this.statePersistenceService=u,this.siteContextParamsService=A,this.eventService=T}getQuantity(){return this.activeCartRequired().pipe((0,p.w)(e=>e?this.activeCartFacade.getActive().pipe((0,M.O)({totalUnitCount:0}),(0,a.U)(i=>i.totalUnitCount||0)):(0,v.of)(0)))}getTotalPrice(){return this.activeCartRequired().pipe((0,p.w)(e=>e?this.activeCartFacade.getActive().pipe((0,a.U)(i=>i.totalPrice?.formattedValue??"")):(0,v.of)("")))}activeCartRequired(){return(0,g.aj)([this.hasActiveCartInStorage(),this.authService.isUserLoggedIn(),this.isCartCreated()]).pipe((0,a.U)(([e,i,u])=>e||i||u),(0,P.x)(),(0,h.o)(e=>!e,!0))}hasActiveCartInStorage(){return this.getCartStateFromBrowserStorage().pipe((0,a.U)(e=>Boolean(e?.active)))}isCartCreated(){return this.eventService.get(_.su).pipe((0,a.U)(e=>!0),(0,M.O)(!1))}getCartStateFromBrowserStorage(){return this.siteContextParamsService.getValues([o.iEg]).pipe((0,a.U)(e=>this.statePersistenceService.readStateFromStorage({key:"cart",context:e,storageType:o.iHd.LOCAL_STORAGE})))}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(_.bu),t.LFG(o.e80),t.LFG(o.WBb),t.LFG(o.Qnj),t.LFG(o.POd))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),D=(()=>{class n{constructor(e){this.miniCartComponentService=e,this.iconTypes=c.e1G,this.quantity$=this.miniCartComponentService.getQuantity(),this.total$=this.miniCartComponentService.getTotalPrice()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(m))},n.\u0275cmp=t.Xpm({type:n,selectors:[["cx-mini-cart"]],decls:13,vars:29,consts:[[3,"routerLink"],[3,"type"],[1,"total"],[1,"count"]],template:function(e,i){1&e&&(t.TgZ(0,"a",0),t.ALo(1,"cxTranslate"),t.ALo(2,"async"),t.ALo(3,"cxUrl"),t._UZ(4,"cx-icon",1),t.TgZ(5,"span",2),t._uU(6),t.ALo(7,"cxTranslate"),t.ALo(8,"async"),t.qZA(),t.TgZ(9,"span",3),t._uU(10),t.ALo(11,"cxTranslate"),t.ALo(12,"async"),t.qZA()()),2&e&&(t.Q6J("routerLink",t.lcZ(3,10,t.DdM(22,O))),t.uIk("aria-label",t.xi3(1,5,"miniCart.item",t.VKq(23,E,t.lcZ(2,8,i.quantity$)))),t.xp6(4),t.Q6J("type",i.iconTypes.CART),t.xp6(2),t.hij(" ",t.xi3(7,12,"miniCart.total",t.VKq(25,f,t.lcZ(8,15,i.total$)))," "),t.xp6(4),t.hij(" ",t.xi3(11,17,"miniCart.count",t.VKq(27,E,t.lcZ(12,20,i.quantity$)))," "))},dependencies:[l.rH,c.oJW,d.Ov,o.l2T,o.X$D],encapsulation:2,changeDetection:0}),n})(),L=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({providers:[(0,o.i51)({cmsComponents:{MiniCartComponent:{component:D}}})],imports:[d.ez,l.Bz,o.bhT,c.QX1,o.LUR]}),n})()}}]);