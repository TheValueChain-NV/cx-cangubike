"use strict";(self.webpackChunkcangubike=self.webpackChunkcangubike||[]).push([[679],{2732:(ut,re,_)=>{_.d(re,{Ru:()=>V,gV:()=>Q,ir:()=>C,t1:()=>yt,u4:()=>X,yN:()=>d});var i=_(4650),R=_(5359),r=_(6761),D=_(2994),p=_(4850),A=_(2986),g=_(7545),y=_(7221),I=_(7168),W=_(2198),P=_(4129),te=_(591),H=_(6053),m=_(1086),se=_(8896),G=_(3749),h=_(5024);class Q{}let M=(()=>{class e{constructor(t){this.adapter=t}get(t,o){return this.adapter.load(t,o)}getHistory(t,o,c,u){return this.adapter.loadHistory(t,o,c,u)}getConsignmentTracking(t,o,c){return this.adapter.getConsignmentTracking(t,o,c)}cancel(t,o,c){return this.adapter.cancel(t,o,c)}return(t,o){return this.adapter.createReturnRequest(t,o)}getReturnRequestDetail(t,o){return this.adapter.loadReturnRequestDetail(t,o)}getReturnRequestList(t,o,c,u){return this.adapter.loadReturnRequestList(t,o,c,u)}cancelReturnRequest(t,o,c){return this.adapter.cancelReturnRequest(t,o,c)}}return e.\u0275fac=function(t){return new(t||e)(i.LFG(Q))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac}),e})();class V{}let j=(()=>{class e{constructor(t){this.adapter=t}placeOrder(t,o,c){return this.adapter.placeOrder(t,o,c)}}return e.\u0275fac=function(t){return new(t||e)(i.LFG(V))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac}),e})();class X{}let a=(()=>{class e{constructor(t){this.adapter=t}reorder(t,o){return this.adapter.reorder(t,o)}}return e.\u0275fac=function(t){return new(t||e)(i.LFG(X))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac}),e})();class C{}let n=(()=>{class e{constructor(t){this.adapter=t}load(t,o){return this.adapter.load(t,o)}loadReplenishmentDetailsHistory(t,o,c,u,S){return this.adapter.loadReplenishmentDetailsHistory(t,o,c,u,S)}cancelReplenishmentOrder(t,o){return this.adapter.cancelReplenishmentOrder(t,o)}loadHistory(t,o,c,u){return this.adapter.loadHistory(t,o,c,u)}}return e.\u0275fac=function(t){return new(t||e)(i.LFG(C))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac}),e})();class d{}let l=(()=>{class e{constructor(t){this.adapter=t}scheduleReplenishmentOrder(t,o,c,u){return this.adapter.scheduleReplenishmentOrder(t,o,c,u)}}return e.\u0275fac=function(t){return new(t||e)(i.LFG(d))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac}),e})();const O="[Order] Load Consignment Tracking",f="[Order] Load Consignment Tracking Success",ne="[Order] Clear Consignment Tracking";class Ue{constructor(s){this.payload=s,this.type=O}}class Te{constructor(s){this.payload=s,this.type="[Order] Load Consignment Tracking Fail"}}class Fe{constructor(s){this.payload=s,this.type=f}}class Ie{constructor(){this.type=ne}}const k="cancelOrder",x="cancelReturn",N="cancelReplenishmentOrder",q="[Order] User Orders",z="[Order] Order Return Requests",T="[Order] Return Request Details",$="[Order] User Order Details",b="[Order] User Replenishment Orders",Y="[Order] User Replenishment Order Details",oe="[Order] Load Order Details",ie="[Order] Load Order Details Success",ce="[Order] Cancel Order";class He extends r.kPG.LoaderLoadAction{constructor(s){super($),this.payload=s,this.type=oe}}class de extends r.kPG.LoaderFailAction{constructor(s){super($,s),this.payload=s,this.type="[Order] Load Order Details Fail"}}class ae extends r.kPG.LoaderSuccessAction{constructor(s){super($),this.payload=s,this.type=ie}}class qe extends r.kPG.LoaderResetAction{constructor(){super($),this.type="[Order] Clear Order Details"}}class ze extends r.kPG.EntityLoadAction{constructor(s){super(r.BzF,k),this.payload=s,this.type=ce}}class $e extends r.kPG.EntityFailAction{constructor(s){super(r.BzF,k,s),this.payload=s,this.type="[Order] Cancel Order Fail"}}class be extends r.kPG.EntitySuccessAction{constructor(){super(r.BzF,k),this.type="[Order] Cancel Order Success"}}class Ye extends r.kPG.EntityLoaderResetAction{constructor(){super(r.BzF,k),this.type="[Order] Reset Cancel Order Process"}}const ue="[Order] Create Order Return Request",le="[Order] Load Order Return Request details",Re="[Order] Cancel Order Return Request",pe="[Order] Load User Order Return Request List",Oe="[Order] Load User Order Return Request List Success";class rr extends r.kPG.LoaderLoadAction{constructor(s){super(T),this.payload=s,this.type=ue}}class tr extends r.kPG.LoaderFailAction{constructor(s){super(T,s),this.payload=s,this.type="[Order] Create Order Return Request Fail"}}class sr extends r.kPG.LoaderSuccessAction{constructor(s){super(T),this.payload=s,this.type="[Order] Create Order Return Request Success"}}class nr extends r.kPG.LoaderLoadAction{constructor(s){super(T),this.payload=s,this.type=le}}class or extends r.kPG.LoaderFailAction{constructor(s){super(T,s),this.payload=s,this.type="[Order] Load Order Return Request details Fail"}}class ir extends r.kPG.LoaderSuccessAction{constructor(s){super(T),this.payload=s,this.type="[Order] Load Order Return Request details Success"}}class cr extends r.kPG.EntityLoadAction{constructor(s){super(r.BzF,x),this.payload=s,this.type=Re}}class dr extends r.kPG.EntityFailAction{constructor(s){super(r.BzF,x,s),this.payload=s,this.type="[Order] Cancel Order Return Request Fail"}}class ar extends r.kPG.EntitySuccessAction{constructor(){super(r.BzF,x),this.type="[Order] Cancel Order Return Request Success"}}class ur extends r.kPG.LoaderLoadAction{constructor(s){super(z),this.payload=s,this.type=pe}}class lr extends r.kPG.LoaderFailAction{constructor(s){super(z,s),this.payload=s,this.type="[Order] Load User Order Return Request List Fail"}}class Rr extends r.kPG.LoaderSuccessAction{constructor(s){super(z),this.payload=s,this.type=Oe}}class pr extends r.kPG.LoaderResetAction{constructor(){super(T),this.type="[Order] Clear Order Return Request Details"}}class Or extends r.kPG.LoaderResetAction{constructor(){super(z),this.type="[Order] Clear Order Return Request List"}}class hr extends r.kPG.EntityLoaderResetAction{constructor(){super(r.BzF,x),this.type="[Order] Reset Cancel Return Request Process"}}const he="[Order] Load User Orders",Ee="[Order] Load User Orders Fail",_e="[Order] Load User Orders Success";class _r extends r.kPG.LoaderLoadAction{constructor(s){super(q),this.payload=s,this.type=he}}class Lr extends r.kPG.LoaderFailAction{constructor(s){super(q,s),this.payload=s,this.type=Ee}}class Sr extends r.kPG.LoaderSuccessAction{constructor(s){super(q),this.payload=s,this.type=_e}}class Le extends r.kPG.LoaderResetAction{constructor(){super(q),this.type="[Order] Clear User Orders"}}const Se="[Order] Load Replenishment Order Details",Ce="[Order] Load Replenishment Order Details Success",ge="[Order] Cancel Replenishment Order",J="[Order] Cancel Replenishment Order Success";class mr extends r.kPG.LoaderLoadAction{constructor(s){super(Y),this.payload=s,this.type=Se}}class vr extends r.kPG.LoaderSuccessAction{constructor(s){super(Y),this.payload=s,this.type=Ce}}class yr extends r.kPG.LoaderFailAction{constructor(s){super(Y,s),this.payload=s,this.type="[Order] Load Replenishment Order Details Fail"}}class Ar extends r.kPG.LoaderResetAction{constructor(){super(Y),this.type="[Order] Clear Replenishment Order Details"}}class Pr extends r.kPG.EntityLoadAction{constructor(s){super(r.BzF,N),this.payload=s,this.type=ge}}class Ur extends r.kPG.EntitySuccessAction{constructor(s){super(r.BzF,N),this.payload=s,this.type=J}}class Tr extends r.kPG.EntityFailAction{constructor(s){super(r.BzF,N,s),this.payload=s,this.type="[Order] Cancel Replenishment Order Fail"}}class Fr extends r.kPG.EntityLoaderResetAction{constructor(){super(r.BzF,N),this.type="[Order] Clear Cancel Replenishment Order"}}const fe="[Order] Load User Replenishment Orders",De="[Order] Load User Replenishment Orders Success";class Nr extends r.kPG.LoaderLoadAction{constructor(s){super(b),this.payload=s,this.type=fe}}class Gr extends r.kPG.LoaderFailAction{constructor(s){super(b,s),this.payload=s,this.type="[Order] Load User Replenishment Orders Fail"}}class kr extends r.kPG.LoaderSuccessAction{constructor(s){super(b),this.payload=s,this.type=De}}class xr extends r.kPG.LoaderResetAction{constructor(){super(b),this.type="[Order] Clear User Replenishment Orders"}}const F=(0,R.ZF)("order"),wr=(0,R.P1)(F,e=>e.consignmentTracking),Hr=(0,R.P1)(wr,e=>e.tracking),me=(0,R.P1)(F,e=>e.orderDetail),qr=(0,R.P1)(me,e=>r.kPG.loaderValueSelector(e)),zr=(0,R.P1)(me,e=>r.kPG.loaderLoadingSelector(e)),Z=(0,R.P1)(F,e=>e.orderReturn),$r=(0,R.P1)(Z,e=>r.kPG.loaderValueSelector(e)),br=(0,R.P1)(Z,e=>r.kPG.loaderLoadingSelector(e)),Yr=(0,R.P1)(Z,e=>r.kPG.loaderSuccessSelector(e)&&!r.kPG.loaderLoadingSelector(e)),ve=(0,R.P1)(F,e=>e.orderReturnList),ee=((0,R.P1)(ve,e=>r.kPG.loaderValueSelector(e)),(0,R.P1)(F,e=>e.orders)),Br=(0,R.P1)(ee,e=>r.kPG.loaderSuccessSelector(e)),B=((0,R.P1)(ee,e=>r.kPG.loaderValueSelector(e)),(0,R.P1)(F,e=>e.replenishmentOrder)),Kr=(0,R.P1)(B,e=>r.kPG.loaderValueSelector(e)),Wr=(0,R.P1)(B,e=>r.kPG.loaderLoadingSelector(e)),Qr=(0,R.P1)(B,e=>r.kPG.loaderSuccessSelector(e)),Vr=(0,R.P1)(B,e=>r.kPG.loaderErrorSelector(e)),w=(0,R.P1)(F,e=>e.replenishmentOrders),jr=((0,R.P1)(w,e=>r.kPG.loaderValueSelector(e)),(0,R.P1)(w,e=>r.kPG.loaderLoadingSelector(e))),Xr=(0,R.P1)(w,e=>r.kPG.loaderErrorSelector(e)),Jr=(0,R.P1)(w,e=>r.kPG.loaderSuccessSelector(e));let Zr=(()=>{class e{constructor(t,o,c,u){this.store=t,this.processStateStore=o,this.userIdService=c,this.routingService=u}getOrderDetails(){return this.store.pipe((0,R.Ys)(qr))}loadOrderDetails(t){this.userIdService.takeUserId().subscribe(o=>{this.store.dispatch(new He({userId:o,orderCode:t}))})}clearOrderDetails(){this.store.dispatch(new qe)}getOrderHistoryList(t){return this.store.pipe((0,R.Ys)(ee),(0,D.b)(o=>{o.loading||o.success||o.error||this.loadOrderList(t)}),(0,p.U)(o=>o.value))}getOrderHistoryListLoaded(){return this.store.pipe((0,R.Ys)(Br))}loadOrderList(t,o,c){this.userIdService.takeUserId(!0).subscribe({next:u=>{let S;this.routingService.getRouterState().pipe((0,A.q)(1)).subscribe(L=>{S=L?.state?.params?.replenishmentOrderCode}).unsubscribe(),this.store.dispatch(new _r({userId:u,pageSize:t,currentPage:o,sort:c,replenishmentOrderCode:S}))},error:()=>{}})}clearOrderList(){this.store.dispatch(new Le)}getConsignmentTracking(){return this.store.pipe((0,R.Ys)(Hr))}loadConsignmentTracking(t,o){this.userIdService.takeUserId().subscribe(c=>{this.store.dispatch(new Ue({userId:c,orderCode:t,consignmentCode:o}))})}clearConsignmentTracking(){this.store.dispatch(new Ie)}cancelOrder(t,o){this.userIdService.takeUserId().subscribe(c=>{this.store.dispatch(new ze({userId:c,orderCode:t,cancelRequestInput:o}))})}getCancelOrderLoading(){return this.processStateStore.pipe((0,R.Ys)(r.VkE.getProcessLoadingFactory(k)))}getCancelOrderSuccess(){return this.processStateStore.pipe((0,R.Ys)(r.VkE.getProcessSuccessFactory(k)))}resetCancelOrderProcessState(){return this.store.dispatch(new Ye)}getOrderDetailsLoading(){return this.store.pipe((0,R.Ys)(zr))}}return e.\u0275fac=function(t){return new(t||e)(i.LFG(R.yh),i.LFG(R.yh),i.LFG(r.XBV),i.LFG(r.Znh))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac}),e})(),et=(()=>{class e{constructor(t,o,c){this.store=t,this.processStateStore=o,this.userIdService=c}createOrderReturnRequest(t){this.userIdService.takeUserId().subscribe(o=>{this.store.dispatch(new rr({userId:o,returnRequestInput:t}))})}getOrderReturnRequest(){return this.store.pipe((0,R.Ys)($r))}getOrderReturnRequestList(t){return this.store.pipe((0,R.Ys)(ve),(0,D.b)(o=>{o.loading||o.success||o.error||this.loadOrderReturnRequestList(t)}),(0,p.U)(o=>o.value))}loadOrderReturnRequestDetail(t){this.userIdService.takeUserId().subscribe(o=>{this.store.dispatch(new nr({userId:o,returnRequestCode:t}))})}loadOrderReturnRequestList(t,o,c){this.userIdService.takeUserId(!0).subscribe({next:u=>{this.store.dispatch(new ur({userId:u,pageSize:t,currentPage:o,sort:c}))},error:()=>{}})}clearOrderReturnRequestList(){this.store.dispatch(new Or)}getReturnRequestLoading(){return this.store.pipe((0,R.Ys)(br))}getReturnRequestSuccess(){return this.store.pipe((0,R.Ys)(Yr))}clearOrderReturnRequestDetail(){this.store.dispatch(new pr)}cancelOrderReturnRequest(t,o){this.userIdService.takeUserId().subscribe(c=>{this.store.dispatch(new cr({userId:c,returnRequestCode:t,returnRequestModification:o}))})}getCancelReturnRequestLoading(){return this.processStateStore.pipe((0,R.Ys)(r.VkE.getProcessLoadingFactory(x)))}getCancelReturnRequestSuccess(){return this.processStateStore.pipe((0,R.Ys)(r.VkE.getProcessSuccessFactory(x)))}resetCancelReturnRequestProcessState(){return this.store.dispatch(new hr)}}return e.\u0275fac=function(t){return new(t||e)(i.LFG(R.yh),i.LFG(R.yh),i.LFG(r.XBV))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac}),e})(),rt=(()=>{class e{constructor(t,o,c,u,S){this.activeCartFacade=t,this.userIdService=o,this.commandService=c,this.orderConnector=u,this.eventService=S,this.placedOrder$=new te.X(void 0),this.placeOrderCommand=this.commandService.create(L=>this.checkoutPreconditions().pipe((0,g.w)(([v,U])=>this.orderConnector.placeOrder(v,U,L).pipe((0,D.b)(K=>{this.placedOrder$.next(K),this.eventService.dispatch({userId:v,cartId:U,cartCode:U,order:K},P.uZ)})))),{strategy:r.flE.CancelPrevious})}checkoutPreconditions(){return(0,H.aj)([this.userIdService.takeUserId(),this.activeCartFacade.takeActiveCartId(),this.activeCartFacade.isGuestCart()]).pipe((0,A.q)(1),(0,p.U)(([t,o,c])=>{if(!t||!o||t===r.Fds&&!c)throw new Error("Checkout conditions not met");return[t,o]}))}placeOrder(t){return this.placeOrderCommand.execute(t)}getOrderDetails(){return this.placedOrder$.asObservable()}clearPlacedOrder(){this.placedOrder$.next(void 0)}setPlacedOrder(t){this.placedOrder$.next(t)}getPickupEntries(){return this.getOrderDetails().pipe((0,p.U)(t=>t?.entries?.filter(o=>void 0!==o.deliveryPointOfService)||[]))}getDeliveryEntries(){return this.getOrderDetails().pipe((0,p.U)(t=>t?.entries?.filter(o=>void 0===o.deliveryPointOfService)||[]))}}return e.\u0275fac=function(t){return new(t||e)(i.LFG(G.bu),i.LFG(r.XBV),i.LFG(r.VDr),i.LFG(j),i.LFG(r.POd))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac}),e})(),tt=(()=>{class e{constructor(t,o,c,u,S){this.commandService=t,this.reorderOrderConnector=o,this.userIdService=c,this.activeCartFacade=u,this.multiCartFacade=S,this.reorderCommand=this.commandService.create(({orderId:L})=>this.reorderPreconditions().pipe((0,g.w)(v=>this.reorderOrderConnector.reorder(L,v))),{strategy:r.flE.CancelPrevious})}reorder(t){return this.reorderCommand.execute({orderId:t})}reorderPreconditions(){return(0,H.aj)([this.userIdService.takeUserId(),this.activeCartFacade.getActiveCartId()]).pipe((0,A.q)(1),(0,p.U)(([t,o])=>{if(!t)throw new Error("Must be logged in to reorder");return o&&this.multiCartFacade.deleteCart(o,t),t}))}}return e.\u0275fac=function(t){return new(t||e)(i.LFG(r.VDr),i.LFG(a),i.LFG(r.XBV),i.LFG(G.bu),i.LFG(G.WT))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac}),e})(),st=(()=>{class e{constructor(t,o,c){this.store=t,this.processStateStore=o,this.userIdService=c}loadReplenishmentOrderDetails(t){this.userIdService.takeUserId(!0).subscribe({next:o=>{this.store.dispatch(new mr({userId:o,replenishmentOrderCode:t}))},error:()=>{}})}getReplenishmentOrderDetails(){return this.store.pipe((0,R.Ys)(Kr))}getReplenishmentOrderDetailsLoading(){return this.store.pipe((0,R.Ys)(Wr))}getReplenishmentOrderDetailsSuccess(){return this.store.pipe((0,R.Ys)(Qr))}getReplenishmentOrderDetailsError(){return this.store.pipe((0,R.Ys)(Vr))}clearReplenishmentOrderDetails(){this.store.dispatch(new Ar)}cancelReplenishmentOrder(t){this.userIdService.takeUserId(!0).subscribe({next:o=>{this.store.dispatch(new Pr({userId:o,replenishmentOrderCode:t}))},error:()=>{}})}getCancelReplenishmentOrderLoading(){return this.processStateStore.pipe((0,R.Ys)(r.VkE.getProcessLoadingFactory(N)))}getCancelReplenishmentOrderSuccess(){return this.processStateStore.pipe((0,R.Ys)(r.VkE.getProcessSuccessFactory(N)))}getCancelReplenishmentOrderError(){return this.processStateStore.pipe((0,R.Ys)(r.VkE.getProcessErrorFactory(N)))}clearCancelReplenishmentOrderProcessState(){this.store.dispatch(new Fr)}getReplenishmentOrderHistoryList(t){return this.store.pipe((0,R.Ys)(w),(0,D.b)(o=>{o.loading||o.success||o.error||this.loadReplenishmentOrderList(t)}),(0,p.U)(o=>o.value))}getReplenishmentOrderHistoryListLoading(){return this.store.pipe((0,R.Ys)(jr))}getReplenishmentOrderHistoryListError(){return this.store.pipe((0,R.Ys)(Xr))}getReplenishmentOrderHistoryListSuccess(){return this.store.pipe((0,R.Ys)(Jr))}loadReplenishmentOrderList(t,o,c){this.userIdService.takeUserId(!0).subscribe({next:u=>{this.store.dispatch(new Nr({userId:u,pageSize:t,currentPage:o,sort:c}))},error:()=>{}})}clearReplenishmentOrderList(){this.store.dispatch(new xr)}}return e.\u0275fac=function(t){return new(t||e)(i.LFG(R.yh),i.LFG(R.yh),i.LFG(r.XBV))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac}),e})(),nt=(()=>{class e{constructor(t,o,c,u,S,L){this.activeCartFacade=t,this.userIdService=o,this.commandService=c,this.scheduledReplenishmentOrderConnector=u,this.eventService=S,this.orderFacade=L,this.scheduleReplenishmentOrderCommand=this.commandService.create(({form:v,termsChecked:U})=>this.checkoutPreconditions().pipe((0,g.w)(([K,Pe])=>this.scheduledReplenishmentOrderConnector.scheduleReplenishmentOrder(Pe,v,U,K).pipe((0,D.b)(at=>{this.orderFacade.setPlacedOrder(at),this.eventService.dispatch({userId:K,cartId:Pe,cartCode:Pe,replenishmentOrder:at},P.oL)})))),{strategy:r.flE.CancelPrevious})}checkoutPreconditions(){return(0,H.aj)([this.userIdService.takeUserId(),this.activeCartFacade.takeActiveCartId(),this.activeCartFacade.isGuestCart()]).pipe((0,A.q)(1),(0,p.U)(([t,o,c])=>{if(!t||!o||t===r.Fds&&!c)throw new Error("Order conditions not met");return[t,o]}))}scheduleReplenishmentOrder(t,o){return this.scheduleReplenishmentOrderCommand.execute({termsChecked:o,form:t})}}return e.\u0275fac=function(t){return new(t||e)(i.LFG(G.bu),i.LFG(r.XBV),i.LFG(r.VDr),i.LFG(l),i.LFG(r.POd),i.LFG(P.Vh))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac}),e})();const Ot=[et,{provide:P.U1,useExisting:et},Zr,{provide:P.Kr,useExisting:Zr},st,{provide:P.kp,useExisting:st},nt,{provide:P.wT,useExisting:nt},rt,{provide:P.Vh,useExisting:rt},tt,{provide:P.t7,useExisting:tt}],ht=[(()=>{class e{constructor(t,o,c){this.actions$=t,this.orderConnector=o,this.replenishmentOrderConnector=c,this.logger=(0,i.f3M)(r.mQy),this.loadUserOrders$=(0,h.GW)(()=>this.actions$.pipe((0,h.l4)(he),(0,p.U)(u=>u.payload),(0,g.w)(u=>(Boolean(u.replenishmentOrderCode)?this.replenishmentOrderConnector.loadReplenishmentDetailsHistory(u.userId,u.replenishmentOrderCode??"",u.pageSize,u.currentPage,u.sort):this.orderConnector.getHistory(u.userId,u.pageSize,u.currentPage,u.sort)).pipe((0,p.U)(S=>new Sr(S)),(0,y.K)(S=>(0,m.of)(new Lr((0,r.cxH)(S,this.logger)))))))),this.resetUserOrders$=(0,h.GW)(()=>this.actions$.pipe((0,h.l4)(r.dO9.LANGUAGE_CHANGE),(0,p.U)(()=>new Le)))}}return e.\u0275fac=function(t){return new(t||e)(i.LFG(h.eX),i.LFG(M),i.LFG(n))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac}),e})(),(()=>{class e{constructor(t,o,c,u,S){this.actions$=t,this.orderConnector=o,this.globalMessageService=c,this.userIdService=u,this.store=S,this.logger=(0,i.f3M)(r.mQy),this.loadOrderDetails$=(0,h.GW)(()=>this.actions$.pipe((0,h.l4)(oe),(0,p.U)(L=>L.payload),(0,g.w)(L=>this.orderConnector.get(L.userId,L.orderCode).pipe((0,p.U)(v=>new ae(v)),(0,y.K)(v=>(0,m.of)(new de((0,r.cxH)(v,this.logger)))))))),this.cancelOrder$=(0,h.GW)(()=>this.actions$.pipe((0,h.l4)(ce),(0,p.U)(L=>L.payload),(0,g.w)(L=>this.orderConnector.cancel(L.userId,L.orderCode,L.cancelRequestInput).pipe((0,p.U)(()=>new be),(0,y.K)(v=>(v.error?.errors.forEach(U=>this.globalMessageService.add(U.message,r.xUg.MSG_TYPE_ERROR)),(0,m.of)(new $e((0,r.cxH)(v,this.logger))))))))),this.resetOrderDetails$=(0,h.GW)(()=>this.actions$.pipe((0,h.l4)(r.dO9.LANGUAGE_CHANGE,r.dO9.CURRENCY_CHANGE),(0,I.M)(this.userIdService.getUserId(),this.store.pipe((0,W.h)(L=>!!L.order?.orderDetail),(0,p.U)(L=>L.order.orderDetail.value?.code))),(0,g.w)(([,L,v])=>v?this.orderConnector.get(L,v).pipe((0,p.U)(U=>new ae(U)),(0,y.K)(U=>(0,m.of)(new de((0,r.cxH)(U,this.logger))))):se.E)))}}return e.\u0275fac=function(t){return new(t||e)(i.LFG(h.eX),i.LFG(M),i.LFG(r.IWp),i.LFG(r.XBV),i.LFG(R.yh))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac}),e})(),(()=>{class e{constructor(t,o){this.actions$=t,this.orderConnector=o,this.logger=(0,i.f3M)(r.mQy),this.loadConsignmentTracking$=(0,h.GW)(()=>this.actions$.pipe((0,h.l4)(O),(0,p.U)(c=>c.payload),(0,g.w)(c=>this.orderConnector.getConsignmentTracking(c.orderCode,c.consignmentCode,c.userId).pipe((0,p.U)(u=>new Fe(u)),(0,y.K)(u=>(0,m.of)(new Te((0,r.cxH)(u,this.logger))))))))}}return e.\u0275fac=function(t){return new(t||e)(i.LFG(h.eX),i.LFG(M))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac}),e})(),(()=>{class e{constructor(t,o){this.actions$=t,this.orderConnector=o,this.logger=(0,i.f3M)(r.mQy),this.createReturnRequest$=(0,h.GW)(()=>this.actions$.pipe((0,h.l4)(ue),(0,p.U)(c=>c.payload),(0,g.w)(c=>this.orderConnector.return(c.userId,c.returnRequestInput).pipe((0,p.U)(u=>new sr(u)),(0,y.K)(u=>(0,m.of)(new tr((0,r.cxH)(u,this.logger)))))))),this.loadReturnRequest$=(0,h.GW)(()=>this.actions$.pipe((0,h.l4)(le),(0,p.U)(c=>c.payload),(0,g.w)(c=>this.orderConnector.getReturnRequestDetail(c.userId,c.returnRequestCode).pipe((0,p.U)(u=>new ir(u)),(0,y.K)(u=>(0,m.of)(new or((0,r.cxH)(u,this.logger)))))))),this.cancelReturnRequest$=(0,h.GW)(()=>this.actions$.pipe((0,h.l4)(Re),(0,p.U)(c=>c.payload),(0,g.w)(c=>this.orderConnector.cancelReturnRequest(c.userId,c.returnRequestCode,c.returnRequestModification).pipe((0,p.U)(()=>new ar),(0,y.K)(u=>(0,m.of)(new dr((0,r.cxH)(u,this.logger)))))))),this.loadReturnRequestList$=(0,h.GW)(()=>this.actions$.pipe((0,h.l4)(pe),(0,p.U)(c=>c.payload),(0,g.w)(c=>this.orderConnector.getReturnRequestList(c.userId,c.pageSize,c.currentPage,c.sort).pipe((0,p.U)(u=>new Rr(u)),(0,y.K)(u=>(0,m.of)(new lr((0,r.cxH)(u,this.logger))))))))}}return e.\u0275fac=function(t){return new(t||e)(i.LFG(h.eX),i.LFG(M))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac}),e})(),(()=>{class e{constructor(t,o,c){this.actions$=t,this.replenishmentOrderConnector=o,this.globalMessageService=c,this.logger=(0,i.f3M)(r.mQy),this.loadReplenishmentOrderDetails$=(0,h.GW)(()=>this.actions$.pipe((0,h.l4)(Se),(0,p.U)(u=>u.payload),(0,g.w)(u=>this.replenishmentOrderConnector.load(u.userId,u.replenishmentOrderCode).pipe((0,p.U)(S=>new vr(S)),(0,y.K)(S=>(0,m.of)(new yr((0,r.cxH)(S,this.logger)))))))),this.cancelReplenishmentOrder$=(0,h.GW)(()=>this.actions$.pipe((0,h.l4)(ge),(0,p.U)(u=>u.payload),(0,g.w)(u=>this.replenishmentOrderConnector.cancelReplenishmentOrder(u.userId,u.replenishmentOrderCode).pipe((0,p.U)(S=>new Ur(S)),(0,y.K)(S=>(S?.error?.errors.forEach(L=>this.globalMessageService.add(L.message,r.xUg.MSG_TYPE_ERROR)),(0,m.of)(new Tr((0,r.cxH)(S,this.logger)))))))))}}return e.\u0275fac=function(t){return new(t||e)(i.LFG(h.eX),i.LFG(n),i.LFG(r.IWp))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac}),e})(),(()=>{class e{constructor(t,o){this.actions$=t,this.replenishmentOrderConnector=o,this.logger=(0,i.f3M)(r.mQy),this.loadUserReplenishmentOrders$=(0,h.GW)(()=>this.actions$.pipe((0,h.l4)(fe),(0,p.U)(c=>c.payload),(0,g.w)(c=>this.replenishmentOrderConnector.loadHistory(c.userId,c.pageSize,c.currentPage,c.sort).pipe((0,p.U)(u=>new kr(u)),(0,y.K)(u=>(0,m.of)(new Gr((0,r.cxH)(u,this.logger))))))))}}return e.\u0275fac=function(t){return new(t||e)(i.LFG(h.eX),i.LFG(n))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac}),e})()],ot={tracking:{}};function Et(e=ot,s){switch(s.type){case f:return{tracking:s.payload};case ne:return ot}return e}const _t={};function Lt(e=_t,s){return s.type===ie?s.payload:e}const it={returnRequests:[],pagination:{},sorts:[]};function St(e=it,s){return s.type===Oe?s.payload?s.payload:it:e}const ye={orders:[],pagination:{},sorts:[]};function Ct(e=ye,s){switch(s.type){case _e:return s.payload?s.payload:ye;case Ee:return ye}return e}const ct={};function gt(e=ct,s){switch(s.type){case Ce:case J:return s.payload?s.payload:ct;default:return e}}const Ae={replenishmentOrders:[],pagination:{},sorts:[]};function ft(e=Ae,s){switch(s.type){case De:return s.payload?s.payload:Ae;case J:{const t=s.payload,o=[...e.replenishmentOrders??[]],c=o.findIndex(u=>u.replenishmentOrderCode===t.replenishmentOrderCode);return-1===c?Ae:(o[c]={...t},{...e,replenishmentOrders:o})}}return e}const dt=new i.OlP("OrderReducers"),mt={provide:dt,useFactory:function Dt(){return{orders:r.kPG.loaderReducer(q,Ct),orderDetail:r.kPG.loaderReducer($,Lt),replenishmentOrders:r.kPG.loaderReducer(b,ft),orderReturn:r.kPG.loaderReducer(T),orderReturnList:r.kPG.loaderReducer(z,St),consignmentTracking:Et,replenishmentOrder:r.kPG.loaderReducer(Y,gt)}}};let vt=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=i.oAB({type:e}),e.\u0275inj=i.cJS({providers:[mt],imports:[h.sQ.forFeature(ht),R.Aw.forFeature("order",dt)]}),e})(),yt=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=i.oAB({type:e}),e.\u0275inj=i.cJS({providers:[...Ot,M,n,j,l,a],imports:[vt]}),e})()},679:(ut,re,_)=>{_.d(re,{FV:()=>X,mb:()=>W});var i=_(4650),R=_(3749),r=_(6761),D=_(529),p=_(4129),A=_(1737),g=_(7221),y=_(6895),I=_(2732);let W=(()=>{class a{constructor(n){this.converter=n}convert(n,d){return void 0===d&&(d={...n}),n.entries&&(d.entries=n.entries.map(l=>this.convertOrderEntry(l,n.code,n.appliedProductPromotions))),n.consignments&&(d.consignments=n.consignments.map(l=>({...l,entries:l.entries?.map(O=>({...O,orderEntry:this.convertOrderEntry(O.orderEntry,n.code,n.appliedProductPromotions)}))}))),n.unconsignedEntries&&(d.unconsignedEntries=n.unconsignedEntries.map(l=>this.convertOrderEntry(l,n.code,n.appliedProductPromotions))),d}convertOrderEntry(n,d,l){return{...n,product:this.converter.convert(n?.product,r.jrf),orderCode:d,promotions:this.converter.convert({item:n,promotions:l},R.Cx)}}}return a.\u0275fac=function(n){return new(n||a)(i.LFG(r.IXI))},a.\u0275prov=i.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})(),P=(()=>{class a{constructor(n){this.converter=n}convert(n,d){return void 0===d&&(d={...n}),n.entries&&(d.entries=n.entries.map(l=>({...l,product:this.converter.convert(l.product,r.jrf),promotions:this.converter.convert({item:l,promotions:n.appliedProductPromotions},R.Cx)}))),d}}return a.\u0275fac=function(n){return new(n||a)(i.LFG(r.IXI))},a.\u0275prov=i.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})(),te=(()=>{class a{constructor(n){this.converter=n}convert(n,d){return void 0===d&&(d={...n}),n.returnEntries&&(d.returnEntries=n.returnEntries.map(l=>({...l,orderEntry:this.convertOrderEntry(l.orderEntry)}))),d}convertOrderEntry(n){return{...n,product:this.converter.convert(n?.product,r.jrf)}}}return a.\u0275fac=function(n){return new(n||a)(i.LFG(r.IXI))},a.\u0275prov=i.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})(),H=(()=>{class a{convert(n,d){return void 0===d&&(d={...n}),n.replenishmentStartDate&&(d.replenishmentStartDate=this.convertDate(n.replenishmentStartDate)),d}convertDate(n){return`${n}T${(new Date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hourCycle:"h23"})}:00${r.IMh.getLocalTimezoneOffset()}`}}return a.\u0275fac=function(n){return new(n||a)},a.\u0275prov=i.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();const m={"Content-Type":"application/json"};let se=(()=>{class a{constructor(n,d,l){this.http=n,this.occEndpoints=d,this.converter=l}load(n,d){const l=this.occEndpoints.buildUrl("orderDetail",{urlParams:{userId:n,orderId:d}});let O=new D.WM;return n===r.Fds&&(O=r.Fox.createHeader(r._Re,!0,O)),this.http.get(l,{headers:O}).pipe(this.converter.pipeable(p.YA))}loadHistory(n,d,l,O){const E={};d&&(E.pageSize=d.toString()),l&&(E.currentPage=l.toString()),O&&(E.sort=O.toString());const f=this.occEndpoints.buildUrl("orderHistory",{urlParams:{userId:n},queryParams:E});return this.http.get(f).pipe(this.converter.pipeable(p.Rc))}getConsignmentTracking(n,d,l=r.zyp){const O=this.occEndpoints.buildUrl("consignmentTracking",{urlParams:{userId:l,orderCode:n,consignmentCode:d}});return this.http.get(O).pipe(this.converter.pipeable(p.m1))}cancel(n,d,l){const O=this.occEndpoints.buildUrl("cancelOrder",{urlParams:{userId:n,orderId:d}}),E=new D.WM({...m});return this.http.post(O,l,{headers:E}).pipe((0,g.K)(f=>(0,A._)(f)))}createReturnRequest(n,d){const l=this.occEndpoints.buildUrl("returnOrder",{urlParams:{userId:n}}),O=new D.WM({...m});return d=this.converter.convert(d,p.Nz),this.http.post(l,d,{headers:O}).pipe((0,g.K)(E=>(0,A._)(E)),this.converter.pipeable(p.Ge))}loadReturnRequestList(n,d,l,O){const E={};d&&(E.pageSize=d.toString()),l&&(E.currentPage=l.toString()),O&&(E.sort=O.toString());const f=this.occEndpoints.buildUrl("orderReturns",{urlParams:{userId:n},queryParams:E});return this.http.get(f).pipe(this.converter.pipeable(p.SL))}loadReturnRequestDetail(n,d){const l=this.occEndpoints.buildUrl("orderReturnDetail",{urlParams:{userId:n,returnRequestCode:d}});return this.http.get(l).pipe(this.converter.pipeable(p.Ge))}cancelReturnRequest(n,d,l){const O=this.occEndpoints.buildUrl("cancelReturn",{urlParams:{userId:n,returnRequestCode:d}}),E=new D.WM({...m});return this.http.patch(O,l,{headers:E}).pipe((0,g.K)(f=>(0,A._)(f)))}}return a.\u0275fac=function(n){return new(n||a)(i.LFG(D.eN),i.LFG(r.Lz0),i.LFG(r.IXI))},a.\u0275prov=i.Yz7({token:a,factory:a.\u0275fac}),a})(),G=(()=>{class a{constructor(n,d,l){this.http=n,this.occEndpoints=d,this.converter=l,this.logger=(0,i.f3M)(r.mQy)}placeOrder(n,d,l){let O=new D.WM({"Content-Type":"application/x-www-form-urlencoded"});return n===r.Fds&&(O=r.Fox.createHeader(r._Re,!0,O)),this.http.post(this.getPlaceOrderEndpoint(n,d,l.toString()),{},{headers:O}).pipe((0,g.K)(E=>(0,A._)((0,r.cxH)(E,this.logger))),(0,r.twT)({shouldRetry:r.Pzz}),this.converter.pipeable(p.YA))}getPlaceOrderEndpoint(n,d,l){return this.occEndpoints.buildUrl("placeOrder",{urlParams:{userId:n},queryParams:{cartId:d,termsChecked:l}})}}return a.\u0275fac=function(n){return new(n||a)(i.LFG(D.eN),i.LFG(r.Lz0),i.LFG(r.IXI))},a.\u0275prov=i.Yz7({token:a,factory:a.\u0275fac}),a})(),h=(()=>{class a{constructor(n,d,l){this.http=n,this.occEndpoints=d,this.converter=l}load(n,d){return this.http.get(this.occEndpoints.buildUrl("replenishmentOrderDetails",{urlParams:{userId:n,replenishmentOrderCode:d}})).pipe(this.converter.pipeable(p.JD))}loadReplenishmentDetailsHistory(n,d,l,O,E){const f={};return l&&(f.pageSize=l.toString()),O&&(f.currentPage=O.toString()),E&&(f.sort=E.toString()),this.http.get(this.occEndpoints.buildUrl("replenishmentOrderDetailsHistory",{urlParams:{userId:n,replenishmentOrderCode:d},queryParams:f})).pipe(this.converter.pipeable(p.Rc))}cancelReplenishmentOrder(n,d){const l=(new D.WM).set("Content-Type","application/json");return this.http.patch(this.occEndpoints.buildUrl("cancelReplenishmentOrder",{urlParams:{userId:n,replenishmentOrderCode:d}}),{},{headers:l}).pipe(this.converter.pipeable(p.JD))}loadHistory(n,d,l,O){const E={};d&&(E.pageSize=d.toString()),l&&(E.currentPage=l.toString()),O&&(E.sort=O.toString());const f=this.occEndpoints.buildUrl("replenishmentOrderHistory",{urlParams:{userId:n},queryParams:E});return this.http.get(f).pipe(this.converter.pipeable(p.HN))}}return a.\u0275fac=function(n){return new(n||a)(i.LFG(D.eN),i.LFG(r.Lz0),i.LFG(r.IXI))},a.\u0275prov=i.Yz7({token:a,factory:a.\u0275fac}),a})(),Q=(()=>{class a{constructor(n,d,l){this.http=n,this.occEndpoints=d,this.converter=l,this.logger=(0,i.f3M)(r.mQy)}scheduleReplenishmentOrder(n,d,l,O){d=this.converter.convert(d,p.dC);const E=(new D.WM).set("Content-Type","application/json");return this.http.post(this.getScheduleReplenishmentOrderEndpoint(O,n,l.toString()),d,{headers:E}).pipe((0,g.K)(f=>(0,A._)((0,r.cxH)(f,this.logger))),(0,r.twT)({shouldRetry:r.Pzz}),this.converter.pipeable(p.JD))}getScheduleReplenishmentOrderEndpoint(n,d,l){return this.occEndpoints.buildUrl("scheduleReplenishmentOrder",{urlParams:{userId:n},queryParams:{cartId:d,termsChecked:l}})}}return a.\u0275fac=function(n){return new(n||a)(i.LFG(D.eN),i.LFG(r.Lz0),i.LFG(r.IXI))},a.\u0275prov=i.Yz7({token:a,factory:a.\u0275fac}),a})(),M=(()=>{class a{convert(n,d){return void 0===d&&(d={...n}),d}}return a.\u0275fac=function(n){return new(n||a)},a.\u0275prov=i.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})(),V=(()=>{class a{constructor(n,d,l){this.http=n,this.occEndpoints=d,this.converter=l,this.logger=(0,i.f3M)(r.mQy)}reorder(n,d){const l=(new D.WM).set("Content-Type","application/json");return this.http.post(this.getReorderOrderEndpoint(n,d),{},{headers:l}).pipe((0,g.K)(O=>(0,A._)((0,r.cxH)(O,this.logger))),this.converter.pipeable(p.W4))}getReorderOrderEndpoint(n,d){return this.occEndpoints.buildUrl("reorder",{urlParams:{userId:d},queryParams:{orderCode:n}})}}return a.\u0275fac=function(n){return new(n||a)(i.LFG(D.eN),i.LFG(r.Lz0),i.LFG(r.IXI))},a.\u0275prov=i.Yz7({token:a,factory:a.\u0275fac}),a})();const j={backend:{occ:{endpoints:{orderHistory:"users/${userId}/orders",orderDetail:"users/${userId}/orders/${orderId}?fields=FULL",consignmentTracking:"users/${userId}/orders/${orderCode}/consignments/${consignmentCode}/tracking",cancelOrder:"users/${userId}/orders/${orderId}/cancellation",returnOrder:"users/${userId}/orderReturns?fields=BASIC,returnEntries(BASIC,refundAmount(formattedValue),orderEntry(basePrice(formattedValue),product(name,code,baseOptions,images(DEFAULT,galleryIndex)))),deliveryCost(formattedValue),totalPrice(formattedValue),subTotal(formattedValue)",orderReturns:"users/${userId}/orderReturns?fields=BASIC",orderReturnDetail:"users/${userId}/orderReturns/${returnRequestCode}?fields=BASIC,returnEntries(BASIC,refundAmount(formattedValue),orderEntry(basePrice(formattedValue),product(name,code,baseOptions,images(DEFAULT,galleryIndex)))),deliveryCost(formattedValue),totalPrice(formattedValue),subTotal(formattedValue)",cancelReturn:"users/${userId}/orderReturns/${returnRequestCode}",replenishmentOrderDetails:"users/${userId}/replenishmentOrders/${replenishmentOrderCode}?fields=FULL,costCenter(FULL),purchaseOrderNumber,paymentType,user",replenishmentOrderDetailsHistory:"users/${userId}/replenishmentOrders/${replenishmentOrderCode}/orders",cancelReplenishmentOrder:"users/${userId}/replenishmentOrders/${replenishmentOrderCode}?fields=FULL,costCenter(FULL),purchaseOrderNumber,paymentType,user",replenishmentOrderHistory:"users/${userId}/replenishmentOrders?fields=FULL,replenishmentOrders(FULL, purchaseOrderNumber)",placeOrder:"users/${userId}/orders?fields=FULL"}}}};let X=(()=>{class a{}return a.\u0275fac=function(n){return new(n||a)},a.\u0275mod=i.oAB({type:a}),a.\u0275inj=i.cJS({providers:[(0,r.i51)(j),{provide:I.gV,useClass:se},{provide:I.ir,useClass:h},{provide:I.Ru,useClass:G},{provide:I.yN,useClass:Q},{provide:I.u4,useClass:V},{provide:p.Ge,useExisting:te,multi:!0},{provide:p.YA,useExisting:W,multi:!0},{provide:p.JD,useExisting:P,multi:!0},{provide:p.dC,useExisting:H,multi:!0},{provide:p.W4,useExisting:M,multi:!0}],imports:[y.ez]}),a})()}}]);